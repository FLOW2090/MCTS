# 计算思维第 7 小组“超级井字棋”蒙特卡洛树算法

## 游戏规则

![layout.jpg](https://github.com/FLOW2090/CODE_CPP/blob/main/ComputationnalThinking/layout.jpg)

“超级井字棋”的特点可概括为将九个井字棋游戏内嵌入一个作为主体的井字棋游戏中，并且在对局中也反复使用其嵌套的特性。具体而言，它的棋盘是在传统的 $3 \times 3$ 网格基础上，把每一大格再划分为 $3 \times 3$ 的小网格。规则如下：

1. 对局的进行
   初始状态下棋盘是空的，双方轮流在小网格内落子（一方为 O，一方为 X），每次只能落一子，直到其中一方达成胜利条件，或者棋盘已满，则对局结束。

2. 落子的要求
    1. 每个子只能落在棋盘的一个小网格中，棋盘的每个小网格亦只能容纳一子。
    2. 第一子可落在任意一个小网格中。
    3. 从第二子开始，根据上一个子的位置确定此子可以落的范围。上一子相对于它所在的大格的位置，就是这一子允许落的大格相对于整个棋盘的位置。比如下面的对局中，第一子是蓝色 O，它相对于它所在的大格而言是中间行的右侧位置，所以第二子红色 X 允许落在的范围是相对于整个棋盘而言的中间行的右侧的大格，即图中的蓝色方框。同理，当第二子确定它的位置后，得到第三子允许落的位置范围是图中的红色方框。

    ![example.jpg](https://github.com/FLOW2090/CODE_CPP/blob/main/ComputationnalThinking/example.jpg)

    4. 如果按照 iii 的要求，将要落的子所允许的范围内已经落满子，但其他大格中还有空格，那么本次落子就可以在任意一个空的网格上落子。

3. 胜利的条件：
    1. 若在一个大格中的某一纵列，横行或者对角线的三个子均为 O 或者 X，则此大格整体可视为“ O 大格”或“ X 大格”。一个大格可以同时是“ O 大格”和“ X 大格”。
    2. 若从整个棋盘来看，这个 $3 \times 3$ 的大格中有某一纵列，横行或者对角线均为“ O 大格”或者“ X 大格”，那么相应的一方胜利。
    3. 若棋盘已满，且双方均不满足 ii 的胜利条件，则统计双方玩家各自形成的纵列，横行或者对角线三子连线总数，形成连线多者胜利，若连线数相同，则记为和棋。只计算每个大格内的三子连线，跨大格的三子连线不计入分数。

## 使用方法

### 与他人博弈

直接运行 `MCTS.cpp` 即可。默认机器人先落子。每次输入机器人落子的位置，等待计算片刻后即可得到下一步推荐落子位置。规定左上角坐标为 $(1, 1)$，右下角坐标为 $(9, 9)$，坐标 $(i, j)$ 代表第 $i$ 行 第 $j$ 列。

### 自博弈

直接运行 `MCTS-Self-Compete.cpp` 即可。可以通过修改第 263 行和第 264 行来控制自博弈两方的模拟次数。随后运行，输入对局轮数，等待片刻后就会输出每一轮的赢家。对局相应轮数后会显示两方胜局局数，平局局数。

## 帮助理解代码框架的说明

[display.jpg](https://github.com/FLOW2090/CODE_CPP/blob/main/ComputationnalThinking/display.jpg)